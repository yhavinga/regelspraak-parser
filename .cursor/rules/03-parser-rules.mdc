---
description: Core parser rules for RegelSpraak v2.1.0 grammar, defining the structure of language constructs and their relationships
globs: ["*.g4"]
alwaysApply: false
---
# RegelSpraak v2.1.0 ANTLR Grammar - Core Parser Rules

**Purpose:**
Define the core grammatical structure of RegelSpraak, focusing on top-level definitions (Objecttypes, Parameters, etc.) and the fundamental structure of a Regel (Rule).

**Instructions:**
Implement these parser rules in the ANTLR v4 grammar file (`RegelSpraak.g4`). These rules define how the tokens generated by the lexer are combined into valid GegevensSpraak definitions and RegelSpraak rule structures. Note that this context provides the main framework; detailed sub-rules for expressions, conditions, and specific result types need to be fully translated from the EBNF in Chapter 13 of the specification (see `04-specific-constructs.mdc`).

**File Pattern:**
pattern: *.g4

**Core Parser Rules Snippet:**

```antlr
// Start Rule
regelSpraakDocument
    : ( definition | regel | beslistabel )* EOF
    ;

// Top-Level Definitions
definition
    : objectTypeDefinition
    | domeinDefinition
    | dimensieDefinition
    | eenheidsysteemDefinition
    | parameterDefinition
    | feitTypeDefinition
    | dagsoortDefinition
    ;

// --- Object Type Definition Structure ---
objectTypeDefinition
    : OBJECTTYPE naamwoord (BEZIELD)? NEWLINE // Assuming NEWLINE token exists or handle via WS skip
      ( objectTypeMember NEWLINE )+
    ;

objectTypeMember
    : koptekst // Optional header separator (define koptekst rule if needed)
    | kenmerkSpecificatie
    | attribuutSpecificatie
    ;

naamwoord // Generic name structure
    : (DE | HET)? identifier (MV identifier RPAREN)?
    ;

identifier // Parser rule using the lexer token
    : IDENTIFIER
    ;

// Placeholder rules for members - detailed structure needed
kenmerkSpecificatie
    : // ... Full definition based on 13.3.2 ...
      ( (naamwoord KENMERK)
      | (naamwoord KENMERK BEZITTELIJK)
      | (IS identifier (MV identifier RPAREN)? KENMERK BIJVOEGLIJK)
      ) tijdlijn? SEMICOLON
    ;

attribuutSpecificatie
    : // ... Full definition based on 13.3.2 ...
      naamwoord (datatype | domeinNaam) (GEDIMENSIONEERD_MET dimensieNaam (EN dimensieNaam)*)? tijdlijn? SEMICOLON
    ;

tijdlijn
    : // ... Full definition based on 13.3.6 ...
      VOOR (VOOR_ELKE_DAG | VOOR_ELKE_MAAND | VOOR_ELK_JAAR)
    ;

datatype : // Placeholder rule needing full definition from 13.3.3
    numeriekDatatype | percentageDatatype | tekstDatatype | booleanDatatype | datumTijdDatatype ;
domeinNaam : identifier;
dimensieNaam : identifier;
koptekst : // Define if needed, e.g., --- Some Text ---
    '---' IDENTIFIER+ ; // Simple example

// --- Parameter Definition Structure ---
parameterDefinition
    : PARAMETER parameterMetLidwoord COLON (datatype | domeinNaam) tijdlijn? SEMICOLON
    ;
parameterMetLidwoord : (DE | HET) parameterNaam;
parameterNaam : identifier;

// --- Rule Definition Structure ---
regel
    : REGEL regelNaam NEWLINE
      (regelVersie)+
    ;

regelNaam : identifier;

regelVersie
    : versie NEWLINE regelSpraakRegel
    ;

versie
    : GELDIG versieGeldigheid
    ;

versieGeldigheid // Based on 13.4.2
    : ALTIJD
    | (VANAF datumOfJaar ( (TM | TOT_EN_MET) datumOfJaar)? )
    | ( (TM | TOT_EN_MET) datumOfJaar )
    ;

datumOfJaar
    : datumLiteral | jaarLiteral // Define these helper rules based on literals
    ;
datumLiteral : DATE_TIME_LITERAL;
jaarLiteral : NUMBER; // Assuming year is a number, refine if specific format needed

regelSpraakRegel // Core Rule Structure (Ref: 4.3, 13.4.2)
    : resultaatDeel NEWLINE? // Optional newline
      (voorwaardeDeel DOT)? NEWLINE? // Optional condition part ending with DOT
      (variabeleDeel)? // Optional variable part
    ;

// --- Core Rule Parts (Placeholders - Need Detail) ---
resultaatDeel // Ref: 9, 13.4.3
    : gelijkstelling
    | kenmerkToekenning
    | objectCreatie
    | feitCreatie
    | consistentieRegel
    | initialisatie
    | verdeling
    | dagsoortResultaatDefinitie
    ;

voorwaardeDeel // Ref: 10, 13.4.12
    : ( (INDIEN | GEDURENDE_DE_TIJD_DAT) (toplevelElementaireVoorwaarde | toplevelSamengesteldeVoorwaarde) )
    | periodeVergelijkingEnkelvoudig // Standalone period condition
    ;

variabeleDeel // Ref: 11, 13.4.2
    : DAARBIJ_GELDT (NEWLINE variabeleOnderdeel)* DOT
    ;

variabeleOnderdeel
    : (DE | HET)? variabeleNaam IS expressie // Needs definition of expressie
    ;
variabeleNaam : identifier;

// Placeholder for main expression rule - Detailed in specific constructs
expressie : IDENTIFIER | NUMBER | STRING_LITERAL ; // Highly simplified placeholder

// Placeholder rules for result types - Need detailed implementation
gelijkstelling : attribuutVanOnderwerp (WORDT_GESTELD_OP | WORDT_BEREKEND_ALS) expressie;
kenmerkToekenning : onderwerpKeten (IS | HEEFT) EEN? kenmerkNaam;
objectCreatie : // Placeholder
    EEN onderwerpKeten HEEFT EEN rolNaam ;
feitCreatie : // Placeholder
    EEN rolNaam VAN EEN onderwerpKeten IS (DE | HET | EEN) rolNaam VAN (DE | HET | EEN) onderwerpKeten ;
consistentieRegel : // Placeholder needs detailed EBNF translation
    (DE | HET)? attribuutNaam VAN EEN onderwerpKeten MOET (GELIJK_AAN | ONGELIJK_AAN) expressie ; // Example sub-form
initialisatie : attribuutVanOnderwerp WORDT_GEINITIALISEERD_OP expressie;
verdeling : // Highly complex placeholder
    attribuutVanOnderwerp WORDT_VERDEELD_OVER attribuutVanOnderwerp WAARBIJ_WORDT_VERDEELD IN_GELIJKE_DELEN ; // Simplest case
dagsoortResultaatDefinitie : EEN DAG IS EEN dagsoortNaam;
dagsoortNaam : identifier;

// Helper rules needed by above placeholders
attribuutVanOnderwerp : (DE | HET | EEN)? attribuutNaam VAN onderwerpKeten;
attribuutNaam : identifier;
onderwerpKeten : (DE | HET | EEN)? identifier; // Highly simplified placeholder
kenmerkNaam : identifier;
rolNaam : identifier;

// Placeholder rules for conditions - Need detailed implementation
toplevelElementaireVoorwaarde : expressie predicaatOperator expressie? ; // Simplified placeholder
toplevelSamengesteldeVoorwaarde : ER AAN ALLE VOLGENDE_VOORWAARDEN VOLDOET COLON (NEWLINE BULLET elementaireVoorwaarde)+ ; // Simplified placeholder
periodeVergelijkingEnkelvoudig : VANAF datumLiteral ; // Simplified placeholder
predicaatOperator : GELIJK_AAN | KLEINER_DAN ; // Simplified placeholder

// --- Basic Beslistabel Structure ---
beslistabel
    : BESLISTABEL regelNaam NEWLINE versie NEWLINE
      tableStructure // Placeholder - See 04-specific-constructs.mdc
    ;

tableStructure : .*? ; // Basic placeholder, indicates content needs special handling or pre-processing